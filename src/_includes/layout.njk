<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://unpkg.com/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script>
  function toggleTheme() {
    const isDark = document.documentElement.classList.toggle('dark-mode');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
    
    // Update ArcGIS Maps to match theme (if they support the theme param)
    document.querySelectorAll('iframe').forEach(frame => {
      const url = new URL(frame.src);
      url.searchParams.set('theme', isDark ? 'dark' : 'light');
      frame.src = url.toString();
    });
  }
</script>
</head>
<body>
    <div class="document-wrapper">
        <nav class="sidebar no-print">
            <h3>Table of Contents</h3>
            {{ content | toc | safe }}
            <button class="print-btn" onclick="window.print()">Save as PDF</button>
        </nav>
        
        <main>
            <h1>{{ title }}</h1>
            {{ content | safe }}

                 <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle Dark Mode">
  ðŸŒ™ Dark Mode
</button>
        </main>
     
    </div>
  

<script>
  // Check for saved user preference
  const currentTheme = localStorage.getItem('theme');
  if (currentTheme === 'dark') {
    document.documentElement.classList.add('dark-mode');
  }

  function toggleTheme() {
    const isDark = document.documentElement.classList.toggle('dark-mode');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');

    // Optional: If your ArcGIS app supports theme params, update them
    document.querySelectorAll('iframe').forEach(frame => {
      const url = new URL(frame.src);
      if (url.hostname.includes("arcgis.com")) {
        url.searchParams.set('theme', isDark ? 'dark' : 'light');
        frame.src = url.toString();
      }
    });
  }
  if (!currentTheme && window.matchMedia('(prefers-color-scheme: dark)').matches) {
  document.documentElement.classList.add('dark-mode');
}
</script>
</body>
</html>